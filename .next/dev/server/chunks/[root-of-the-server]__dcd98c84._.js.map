{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/farooq-ashiru/Desktop/Main_Projects/LearnAnything/src/lib/config.ts"],"sourcesContent":["/**\n * THIS FILE IS JUS FOR TYPE SAFETY AND PREVENT APP FROM BREAKING LATER IF WE FOROT TO ADD ENV SHA\n * ALSO REMEMBERR TO ADD NEW ENV VARIABLES HERE THO\n */\n\nimport { z } from \"zod\";\n\nconst envSchema = z.object({\n  // Server-side variables (Secret)\n  JWT_SECRET: z.string().min(32, \"SESSION_SECRET must be at least 32 chars\"),\n  BACKEND_API_URL: z.string().url(),\n  NODE_ENV: z\n    .enum([\"development\", \"test\", \"production\"])\n    .default(\"development\"),\n\n  // Client-side variables (Public  start with NEXT_PUBLIC_)\n  // NEXT_PUBLIC_BACKEND_API_URL: z.string().optional(),\n});\n\n//console.log(process.env);\n// Validate process.env\nconst _env = envSchema.safeParse(process.env);\n\nif (!_env.success) {\n  console.error(\"âŒ Invalid environment variables:\", _env.error.format());\n  throw new Error(\"Invalid environment variables\");\n}\n\nexport const env = _env.data;\n"],"names":[],"mappings":";;;;AAAA;;;CAGC,GAED;;AAEA,MAAM,YAAY,+QAAC,CAAC,MAAM,CAAC;IACzB,iCAAiC;IACjC,YAAY,+QAAC,CAAC,MAAM,GAAG,GAAG,CAAC,IAAI;IAC/B,iBAAiB,+QAAC,CAAC,MAAM,GAAG,GAAG;IAC/B,UAAU,+QAAC,CACR,IAAI,CAAC;QAAC;QAAe;QAAQ;KAAa,EAC1C,OAAO,CAAC;AAIb;AAEA,2BAA2B;AAC3B,uBAAuB;AACvB,MAAM,OAAO,UAAU,SAAS,CAAC,QAAQ,GAAG;AAE5C,IAAI,CAAC,KAAK,OAAO,EAAE;IACjB,QAAQ,KAAK,CAAC,oCAAoC,KAAK,KAAK,CAAC,MAAM;IACnE,MAAM,IAAI,MAAM;AAClB;AAEO,MAAM,MAAM,KAAK,IAAI"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///home/farooq-ashiru/Desktop/Main_Projects/LearnAnything/src/server/utils/session.ts"],"sourcesContent":["import \"server-only\"; // ðŸ›¡ï¸ Security: Build fails if this is imported in client\nimport { SignJWT, jwtVerify } from \"jose\";\nimport { cookies } from \"next/headers\";\nimport { env } from \"@/src/lib/config\"; // Our type-safe env\n\nconst secretKey = env.JWT_SECRET;\nconst encodedKey = new TextEncoder().encode(secretKey);\n\ntype SessionPayload = {\n  accessToken: string;\n  refreshToken: string;\n  expiresAt: Date;\n};\n\nexport async function encrypt(payload: SessionPayload) {\n  return new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"1d\") // Match your backend token expiry\n    .sign(encodedKey);\n}\n\nexport async function decrypt(session: string | undefined = \"\") {\n  try {\n    const { payload } = await jwtVerify(session, encodedKey, {\n      algorithms: [\"HS256\"],\n    });\n    return payload as SessionPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\nexport async function createSession(accessToken: string, refreshToken: string) {\n  const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 1 day\n  const token = (await encrypt({\n    accessToken,\n    refreshToken,\n    expiresAt,\n  })) as string;\n\n  (await cookies()).set(\"session\", token, {\n    httpOnly: true,\n    secure: env.NODE_ENV === \"production\",\n    expires: expiresAt,\n    sameSite: \"lax\",\n    path: \"/\",\n  });\n}\n\nexport async function deleteSession() {\n  (await cookies()).delete(\"session\");\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA,0jBAAsB,0DAA0D;AAChF;AAAA;AACA;AACA,8RAAwC,oBAAoB;;;;;AAE5D,MAAM,YAAY,wKAAG,CAAC,UAAU;AAChC,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC;AAQrC,eAAe,QAAQ,OAAuB;IACnD,OAAO,IAAI,8PAAO,CAAC,SAChB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAAM,kCAAkC;KAC1D,IAAI,CAAC;AACV;AAEO,eAAe,QAAQ,UAA8B,EAAE;IAC5D,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,kQAAS,EAAC,SAAS,YAAY;YACvD,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,cAAc,WAAmB,EAAE,YAAoB;IAC3E,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK,OAAO,QAAQ;IACtE,MAAM,QAAS,MAAM,QAAQ;QAC3B;QACA;QACA;IACF;IAEA,CAAC,MAAM,IAAA,sTAAO,GAAE,EAAE,GAAG,CAAC,WAAW,OAAO;QACtC,UAAU;QACV,QAAQ,wKAAG,CAAC,QAAQ,KAAK;QACzB,SAAS;QACT,UAAU;QACV,MAAM;IACR;AACF;AAEO,eAAe;IACpB,CAAC,MAAM,IAAA,sTAAO,GAAE,EAAE,MAAM,CAAC;AAC3B"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///home/farooq-ashiru/Desktop/Main_Projects/LearnAnything/src/proxy.ts"],"sourcesContent":["//Named this proxy.ts instead of middleware.ts because new nextjs version deprecated middleware.ts  so un name middleware.ts as proxy.ts\n\nimport { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport { decrypt } from \"./server/utils/session\";\n\n//  Define protected and public routes\nconst protectedRoutes = [\"/dashboard\", \"/profile\", \"/settings\"];\nconst publicRoutes = [\"/signin\", \"/signup\", \"/\"];\n\nexport default async function middleware(req: NextRequest) {\n  //  Check if the current route is protected\n  const path = req.nextUrl.pathname;\n  const isProtectedRoute = protectedRoutes.some((route) =>\n    path.startsWith(route),\n  );\n  const isPublicRoute = publicRoutes.includes(path);\n\n  //  Decrypt the session from the cookie\n  const cookie = req.cookies.get(\"session\")?.value;\n  const session = await decrypt(cookie); // Decrypt the session from the server folder in the src folder\n\n  //  Redirect Logic\n  // in case:  User is NOT logged in and tries to access a protected route\n  if (isProtectedRoute && !session?.accessToken) {\n    return NextResponse.redirect(new URL(\"/signin\", req.nextUrl));\n  }\n\n  // in Case : User IS logged in and tries to access login/register (it optional UX improvement sha)\n  if (isPublicRoute && session?.accessToken && path !== \"/\") {\n    return NextResponse.redirect(new URL(\"/dashboard\", req.nextUrl));\n  }\n\n  return NextResponse.next();\n}\n\n//  Config to prevent middleware from running on static files (images, fonts)\nexport const config = {\n  matcher: [\"/((?!api|_next/static|_next/image|.*\\\\.png$).*)\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA,wIAAwI;AAExI;AAEA;;;AAEA,sCAAsC;AACtC,MAAM,kBAAkB;IAAC;IAAc;IAAY;CAAY;AAC/D,MAAM,eAAe;IAAC;IAAW;IAAW;CAAI;AAEjC,eAAe,WAAW,GAAgB;IACvD,2CAA2C;IAC3C,MAAM,OAAO,IAAI,OAAO,CAAC,QAAQ;IACjC,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAC,QAC7C,KAAK,UAAU,CAAC;IAElB,MAAM,gBAAgB,aAAa,QAAQ,CAAC;IAE5C,uCAAuC;IACvC,MAAM,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC,YAAY;IAC3C,MAAM,UAAU,MAAM,IAAA,yLAAO,EAAC,SAAS,+DAA+D;IAEtG,kBAAkB;IAClB,wEAAwE;IACxE,IAAI,oBAAoB,CAAC,SAAS,aAAa;QAC7C,OAAO,0TAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,IAAI,OAAO;IAC7D;IAEA,kGAAkG;IAClG,IAAI,iBAAiB,SAAS,eAAe,SAAS,KAAK;QACzD,OAAO,0TAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,IAAI,OAAO;IAChE;IAEA,OAAO,0TAAY,CAAC,IAAI;AAC1B;AAGO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAkD;AAC9D"}}]
}